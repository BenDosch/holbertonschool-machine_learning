#!/usr/bin/env python3
"""Module containing the class LSTMCell that represents an LSTM unit."""

import numpy as np


class LSTMCell():
    """Class that represents an LSTM unit."""

    def __init__(self, i, h, o):
        """Class constructor that creates the public instance attributes
        Wf, Wu, Wc, Wo, Wy, bf, bu, bc, bo, by that represent the weights and
        biases of the cell. Wf and bf are for the forget gate. Wu and bu are
        for the update gate. Wc and bc are for the intermediate cell state. Wo
        and bo are for the output gate. Wy and by are for the outputs. The
        weights are initialized using a random normal distribution in the order
        listed previously. The weights will be used on the right side for
        matrix multiplication. The biases are initialized as zeros.

        Args:
            i (int): The dimensionality of the data.
            h (int): The dimensionality of the hidden state.
            o (int): The dimensionality of the outputs.
        """
        self.Wf = np.random.normal(size=(h + i, h))
        self.Wu = np.random.normal(size=(h + i, h))
        self.Wc = np.random.normal(size=(h + i, h))
        self.Wo = np.random.normal(size=(h + i, h))
        self.Wy = np.random.normal(size=(h, o))
        self.bf = np.zeros((1, h))
        self.bu = np.zeros((1, h))
        self.bc = np.zeros((1, h))
        self.bo = np.zeros((1, h))
        self.by = np.zeros((1, o))

    def forward(self, h_prev, c_prev, x_t):
        """Function that performs forward propagation for one time step.

        Args:
            h_prev (numpy.ndarray): A tensor of shape of shape (m, h)
                containing the previous hidden state, where m is the batch size
                for the data and h is the dimensionality of the hidden state.
            c_prev (numpy.ndarray): A tensor of shape (m, h) containing the
                previous cell state, where m is the batch size for the data
                and h is the dimensionality of the hidden state.
            x_t (numpy.ndarray): A tensor of shape (m, i) that contains the
                data input for the cell, where m is the batche size for the
                data and i is the dimensionality of the data.

        Returns:
            h_next (numpy.ndarray): A tensor of shape (m, h) that contains the
                next hidden state, where m is the batch size for the data and h
                is the dimensionality of the hidden state.
            c_next (numpy.ndarray): A tensor of shape (m, h) that contains the
                next cell state, where m is the batch size for the data and h
                is the dimensionality of the hidden state.
            y (numpy.ndarray): A tensor of shape (m, o) that contains the
                output of the cell, where m is the batch size for the
                data and o is the dimensionality of the outputs.
        """
        # Combine input and hidden state
        combined = np.concatenate((h_prev, x_t), axis=1)  # (m, h + i)
        # Forget gate
        forget_g = self.sigmoid((combined @ self.Wf) + self.bf)  # (m, h)
        # Update gate
        update_g = self.sigmoid((combined @ self.Wu) + self.bu)  # (m, h)
        # Candidate
        candidate = np.tanh((combined @ self.Wc) + self.bc)  # (m, h)
        # Output gate
        output_g = self.sigmoid((combined @ self.Wo) + self.bo)  # (m, h)
        # New cell state = (f[t] * c[t-1]) + (u[t] * ca[t])
        c_next = (forget_g * c_prev) + (update_g * candidate)  # (m, h)
        # Hidden state
        h_next = (output_g * np.tanh(c_next))  # (m, h)
        # Output to find y
        y = self.softmax((h_next @ self.Wy) + self.by)  # (m, o)

        return h_next, c_next, y

    def sigmoid(self, y):
        """Sigmoid activation function

        Args:
            y (numpy.ndarray): A 2D tensor to apply the soft max activation on.

        Returns:
            The sigmoid activated version of y.
        """
        return 1 / (1 + np.exp(-y))

    def softmax(self, y):
        """Softmax activation function.

        Args:
            y (numpy.ndarray): A 2D tensor to apply the soft max activation on.

        Returns:
            The softmax activated version of y.
        """
        return np.exp(y) / (np.sum(np.exp(y), axis=1, keepdims=True))


# Testing
if __name__ == "__main__":
    np.random.seed(3)
    lstm_cell = LSTMCell(10, 15, 5)
    print("Wf:", lstm_cell.Wf)
    print("Wu:", lstm_cell.Wu)
    print("Wc:", lstm_cell.Wc)
    print("Wo:", lstm_cell.Wo)
    print("Wy:", lstm_cell.Wy)
    print("bf:", lstm_cell.bf)
    print("bu:", lstm_cell.bu)
    print("bc:", lstm_cell.bc)
    print("bo:", lstm_cell.bo)
    print("by:", lstm_cell.by)
    lstm_cell.bf = np.random.randn(1, 15)
    lstm_cell.bu = np.random.randn(1, 15)
    lstm_cell.bc = np.random.randn(1, 15)
    lstm_cell.bo = np.random.randn(1, 15)
    lstm_cell.by = np.random.randn(1, 5)
    h_prev = np.random.randn(8, 15)
    c_prev = np.random.randn(8, 15)
    x_t = np.random.randn(8, 10)
    h, c, y = lstm_cell.forward(h_prev, c_prev, x_t)
    print(h.shape)
    print(h)
    print(c.shape)
    print(c)
    print(y.shape)
    print(y)

# Expected Output
"""
Wf: [[ 1.78862847e+00  4.36509851e-01  9.64974681e-02 -1.86349270e+00
  -2.77388203e-01 -3.54758979e-01 -8.27414815e-02 -6.27000677e-01
  -4.38181690e-02 -4.77218030e-01 -1.31386475e+00  8.84622380e-01
   8.81318042e-01  1.70957306e+00  5.00336422e-02]
 [-4.04677415e-01 -5.45359948e-01 -1.54647732e+00  9.82367434e-01
  -1.10106763e+00 -1.18504653e+00 -2.05649899e-01  1.48614836e+00
   2.36716267e-01 -1.02378514e+00 -7.12993200e-01  6.25244966e-01
  -1.60513363e-01 -7.68836350e-01 -2.30030722e-01]
 [ 7.45056266e-01  1.97611078e+00 -1.24412333e+00 -6.26416911e-01
  -8.03766095e-01 -2.41908317e+00 -9.23792022e-01 -1.02387576e+00
   1.12397796e+00 -1.31914233e-01 -1.62328545e+00  6.46675452e-01
  -3.56270759e-01 -1.74314104e+00 -5.96649642e-01]
 [-5.88594380e-01 -8.73882298e-01  2.97138154e-02 -2.24825777e+00
  -2.67761865e-01  1.01318344e+00  8.52797841e-01  1.10818750e+00
   1.11939066e+00  1.48754313e+00 -1.11830068e+00  8.45833407e-01
  -1.86088953e+00 -6.02885104e-01 -1.91447204e+00]
 [ 1.04814751e+00  1.33373782e+00 -1.97414679e-01  1.77464503e+00
  -6.74727510e-01  1.50616865e-01  1.52945703e-01 -1.06419527e+00
   4.37946611e-01  1.93897846e+00 -1.02493087e+00  8.99338446e-01
  -1.54506852e-01  1.76962730e+00  4.83788348e-01]
 [ 6.76216400e-01  6.43163281e-01  2.49086707e-01 -1.39576350e+00
   1.39166291e+00 -1.37066901e+00  2.38563192e-01  6.14077088e-01
  -8.37912273e-01  1.45063214e-01  1.16788229e+00 -2.41044701e-02
  -8.88657418e-01 -2.91573775e+00 -9.71840503e-01]
 [-5.91078738e-01 -5.16417368e-01 -9.59996180e-01  3.77295234e-01
  -5.74708420e-01 -1.09454334e-01  6.79071600e-01 -8.55437169e-01
  -3.00206075e-01  2.15814934e+00  8.74285723e-01 -1.29353663e+00
  -7.97409382e-02  5.64485518e-01  1.23347104e+00]
 [ 1.48986395e-01 -5.30582144e-01 -7.30526644e-01  6.45061985e-01
   3.13060374e-01 -5.16647925e-01 -1.89071666e-01 -4.16198015e-01
   7.24657658e-01 -6.89960677e-01  4.86414475e-01  8.51518950e-01
   4.86249326e-01 -8.34239851e-01  1.34499246e+00]
 [-6.78212679e-01  4.26435074e-01 -7.53334794e-01 -1.74411025e+00
   2.25750266e-01  2.87035165e-01 -7.74409606e-02  2.76068497e-01
  -6.48410888e-01 -7.37464837e-01 -1.68090099e-01  1.90927681e+00
   8.14814541e-01 -5.19991754e-01  5.58713205e-01]
 [-4.78364660e-01 -4.57260787e-01  8.59284008e-01 -5.25264645e-01
  -1.67563463e+00 -9.06494701e-01  8.84152062e-02  1.28007821e-01
   1.24161652e+00 -7.16025798e-01  7.31465736e-01  4.25966750e-01
  -1.49013772e-01  8.35843902e-01  4.92118903e-01]
 [-8.62308487e-01  1.07168393e+00 -1.22090192e+00  5.96154331e-02
   2.44416199e-03  4.24635721e-01 -7.25433480e-01 -3.49433856e-02
  -1.40620027e-01  9.97088367e-01 -7.95914693e-01  7.27455292e-02
  -2.61240485e-01 -1.29804664e+00  2.67611247e+00]
 [-7.12190272e-02 -1.48665807e+00  1.40862696e+00 -1.07058550e+00
   3.70869972e-01  8.62832095e-01 -6.48432023e-01 -4.30890055e-01
  -5.40270264e-01 -1.29361010e-01 -1.62246117e+00 -1.23563662e+00
  -1.40786442e-01  1.03895212e+00  6.31744177e-01]
 [ 1.72941743e+00  6.94052272e-01 -5.11128993e-01 -1.22843406e-01
  -2.03039355e+00 -9.60775110e-01 -1.02035928e+00  2.70593425e-01
   6.47829797e-01 -5.60373419e-01 -5.88501620e-01 -1.54655582e+00
  -1.27762058e-01  2.48168027e-01  4.45780959e-01]
 [-7.82709043e-01  1.98848968e+00  1.19505834e+00 -9.52375987e-02
  -5.27187779e-01 -3.21584693e-01  1.51130372e-01 -1.86277156e-02
   4.83528787e-01  7.68965158e-01  1.36624284e+00  1.14726479e+00
  -1.10229155e-01  3.88250414e-01 -3.87127181e-01]
 [-5.87220312e-01  1.91082685e+00 -4.59846150e-01  1.99073781e+00
  -3.49035393e-01  2.52825091e-01  1.08940955e+00  2.39220218e-02
   3.93125281e-01 -2.41384800e-01 -4.75524858e-01 -1.65777023e-01
  -6.49717421e-01  1.63138295e+00 -1.67698603e-01]
 [ 1.72266920e+00 -2.68510868e+00  1.84207947e-02  5.61951672e-01
  -2.93821238e-01  1.09465308e+00  6.39692355e-01 -2.74600120e-01
   4.35009258e-01  2.81187838e+00  2.51995127e-01  2.99502331e-01
  -4.39991311e-01  1.33497041e-01 -1.28926119e+00]
 [-1.98290257e-01  2.45758763e+00  1.06721555e+00  6.41420656e-01
   1.10392166e+00  1.88175499e+00  5.93588115e-01  2.07087853e+00
   1.06979836e+00  1.66519510e-01  1.71947656e+00 -2.35921474e+00
  -5.71348962e-01  2.65787047e-01 -9.12090913e-01]
 [-1.56058403e-01 -6.38790896e-01 -6.54415212e-01  2.71192633e+00
   6.27473889e-01 -5.39478492e-02  1.31516722e+00 -2.37337476e-01
   8.85339675e-01  3.50815841e-01  1.62657360e+00 -1.41987131e+00
   7.65721072e-01  1.22249745e-01 -1.15738338e+00]
 [ 1.06542018e+00 -8.72375661e-01  1.61923848e+00  5.13093008e-01
   6.95483983e-01  8.04573882e-02  9.04528487e-01 -1.86565117e+00
   7.47277939e-02 -6.28250807e-01  2.82660307e-01 -4.71569067e-02
   6.16577883e-01 -8.37631447e-01  1.83915189e+00]
 [ 2.31585860e+00 -2.08283418e-01 -1.49731858e-02  2.87557650e-01
   1.26408575e+00  1.89690096e+00 -1.20580279e+00 -6.15108564e-01
  -1.06215612e+00 -1.11278115e+00 -1.63929625e+00  3.62803486e-01
  -1.15903647e+00  1.50326195e+00  9.08318716e-01]
 [-1.02970953e+00 -1.03020862e+00 -6.12384418e-01  1.39996550e+00
  -8.49607360e-01 -1.49354967e+00 -4.94238853e-02  3.73389944e-01
  -6.57257485e-01  1.61943081e+00  2.40456780e-01  4.53037787e-01
  -8.55532721e-01 -3.97298386e-02 -1.56518814e-01]
 [-2.27224411e+00  2.87657229e-01 -1.79480704e+00 -2.87856456e-02
  -1.47394283e+00  2.01965064e+00  3.26262273e-01  8.61357614e-01
   9.19008131e-01 -1.32448870e+00 -2.28179231e+00 -3.29578153e-01
   8.97149747e-01  9.10345116e-02  7.85432247e-01]
 [ 9.36632573e-01 -1.49239710e+00  2.87683724e-01  1.96647463e+00
  -5.70532295e-01 -2.02907213e+00 -2.31904553e-01 -4.64668721e-01
   4.18381023e-01 -8.92406335e-01  9.07167730e-02 -2.21741761e+00
   8.53963372e-01  1.58686654e+00  1.29787761e+00]
 [-1.51521566e+00  3.19196176e-01 -2.98397020e+00  2.83185922e-01
  -6.43601719e-02 -9.95794244e-01  3.43794518e-01  1.38014655e-01
   9.39502854e-01  1.27308524e-01  2.35027013e-01 -1.94507226e+00
  -1.15972295e+00 -4.75899387e-01  2.96844531e-01]
 [-6.29877896e-03  1.50089036e+00 -8.70159190e-01 -2.39632073e-01
   2.55080695e-01 -2.31497410e-01  4.95580395e-01 -5.70562824e-01
   1.42034231e+00 -3.19590141e-01  1.11594518e+00 -3.03033672e-02
   1.49152235e+00 -1.39811601e+00  5.16797554e-01]]
Wu: [[-0.43257638  0.23140076  1.19280517 -1.1390968  -1.32202973 -0.99836688
   0.25438757 -1.88683693  0.09659373 -1.28622933 -1.14372183 -0.36917775
   0.38059758 -0.6264145  -0.49204389]
 [-0.04184423 -0.27273554 -2.67652137 -0.43010061  0.08496406  1.09777949
   2.04633278  0.66698785  0.07909219 -0.96476347  0.08905337  0.7788969
   1.26464491 -0.88051133  0.2364056 ]
 [ 0.81560447  1.86081167  0.25559049 -0.54150372 -0.68959966 -0.35744073
  -0.6519202   0.82653585  1.06930572  0.72485682  1.19218624 -0.45376854
   0.38033506 -0.38466318  0.04365869]
 [ 1.22498574 -0.02973531 -1.8648058  -0.25281599 -0.7128498  -1.50891712
  -0.79036569  0.9606248   1.68091065 -0.48900604  1.00253584  1.1782221
  -1.15979227 -0.0393627  -0.04446017]
 [ 0.17238568 -1.59375081 -0.34914224  1.05782121  1.2622032   1.83136208
  -0.33750905  1.86950756  0.66590511 -1.35920117  0.76160928 -0.35228003
   0.51907626 -0.10252394  1.20823864]
 [ 0.25656016 -0.28250502  0.96496577  0.25622178 -0.4129564   1.27727436
  -0.40834524 -0.63713486 -0.53957461 -1.46547209 -0.55320717  1.86087769
  -0.90828394  0.0084189  -1.10818335]
 [-0.61135315  1.51869216  0.89635574 -0.61025035  0.00622012 -0.82600396
  -0.78420535 -0.9148222  -0.89713978  0.32594927  0.59679317  0.48824249
  -0.16943686 -1.3580452  -0.06711047]
 [-0.92429374  0.88130113  0.55644294  0.74689153 -0.34836832 -1.81101917
   0.95789639  1.22632133 -1.48331661  0.13791604  1.19325258 -1.07572355
   1.76768278 -0.34903246 -1.07539011]
 [ 1.37165804  0.29453214 -0.65313816  0.87978795 -1.95576713  1.81530638
  -0.81625006  0.28598427 -0.39861617  0.43623211  0.88792572 -0.8238861
   0.78636292 -0.29403325 -0.68785951]
 [-0.22404361 -1.00460861 -0.79566757  0.94913384 -0.15082304  1.1415331
   0.43175699 -1.0259683  -1.89787143 -0.68724182  0.26412649  0.00881292
  -0.83009562  1.0128123  -1.7457235 ]
 [-1.25864659  0.1272951   2.19376315  0.41393413 -1.00523966  0.59265714
   0.68339657  0.93785693 -0.40986453 -0.79972644  0.11821728  0.41527488
   1.59823525  2.08964887 -0.73306993]
 [-0.52297163 -0.06357308 -0.24977211  0.48579018  0.48573721  0.25789698
   1.34407129 -0.15851092 -1.05080794 -1.56060123 -1.02813987 -1.04425792
  -1.88342383  0.66318777  0.18526784]
 [-0.42279273 -0.88988898 -1.58094538 -0.9197196   1.84790906 -2.21079164
   0.14181052  0.74363697  0.13613223 -0.31680492  0.76807394 -1.10332826
   0.555545    1.43069737 -1.04137439]
 [-0.81983341  0.13594038  0.9895728   1.3391483   0.68062695 -0.66950277
  -1.11441271  0.24297858  0.39825763 -1.10055231  0.05979049  0.33223747
   1.04506399 -0.9905627   0.55696453]
 [-1.1692758  -0.42658598 -0.07827675  1.51791626  3.31430424  0.25354568
   0.4952915   1.00754161 -1.36165622  0.7656634  -1.24173986  1.62911197
   1.44349176  0.50153968 -0.80669851]
 [ 1.66802527  0.25968837  0.11024354  0.57954335 -1.71234657  0.42849942
   0.99610815  0.33900098  0.14525875 -0.95365812  0.64355483  0.20046895
   0.00906379 -0.56320492  0.85617111]
 [ 1.24718437  0.38814617  0.89674907  1.3260233   1.58816115  0.22565015
  -0.21332802 -0.41494587  0.01374701  0.55196641  0.93818194 -0.42674202
   0.14985756 -0.99658002  1.26396401]
 [-0.39146105  0.35792113 -0.71937006 -0.29827604 -0.6859961   1.70496656
   0.35936374 -0.16644467 -0.94764232 -0.61029971  0.56870506  1.66592502
  -1.43088883 -0.91704656 -0.17578816]
 [-0.62826735 -1.65918207  0.01930975  0.75104255 -1.57711136  0.21095978
   0.96467291  0.98032733 -0.41987069  2.30474905  0.5551134  -0.81106622
   0.98429894 -1.12258797  0.89526945]
 [-1.26205434  0.79054257 -0.58356177  1.13228806  0.74067741  0.44720792
   0.05863243  1.08701626 -1.80334191  0.43255434  0.4134327   0.56214989
   0.82622882  3.70245824  0.11678267]
 [ 0.80449953  0.1523685   1.57266807 -2.02081048  1.69794753 -0.68380642
  -2.26224129 -1.07818558 -0.17451934  0.19424525 -0.04589136  0.81681772
  -0.03517699 -0.0631976  -2.14351553]
 [ 0.48734407  1.0102417  -0.42067283 -1.8770843  -1.33650549  1.67356164
  -0.60620725 -0.66458388 -0.81945109  0.68088412 -0.58784355 -0.86903192
  -1.50636278 -0.10779898  1.00094767]
 [-0.14793288  0.88221968  0.17542639  0.14783687  0.17897291  0.03444142
   1.02620502  0.4878529  -0.57811068  0.12862005 -0.07596463  0.48493198
   0.18031665  0.41457794 -1.47732184]
 [ 0.37959116  1.31361206 -1.35019394  1.60093254  0.29707272 -0.2077485
  -1.80448815  1.08759702 -0.96954954 -0.51119077  0.54590427 -1.02557987
  -0.9868334  -1.15128032 -0.11136018]
 [ 0.58853642  0.40300606  0.40740281 -0.34418024  0.14046942 -0.69004075
   1.99767531  0.19472715 -1.95498537 -1.0693078   1.60130281 -1.36648729
  -0.43769479  0.40362572 -1.09662368]]
Wc: [[ 1.0666047   1.67908348 -0.82473917  1.12929566 -0.89122301 -0.99794991
   0.24568509  0.23793134 -0.5960354   0.84202424 -1.46918165 -0.85566594
  -1.07786939  0.75836367  0.8039022 ]
 [ 0.66694045 -1.29560047  0.13276813  0.45765351 -1.61697998 -0.8216931
   0.64586234  0.70365416  0.2552348   0.54207567  0.32409606  0.14991872
  -0.10925686 -0.87143223 -0.24554832]
 [-0.40291494  2.31777471  0.26024073 -0.01069513 -0.2319775  -0.11520507
  -0.27226691  0.54470501 -0.02944483  0.8110797  -0.69517609  0.35023459
   0.8771562  -1.15425899  0.16777   ]
 [ 0.24706745 -0.33474727 -0.48716098 -1.85491011  1.14882126 -0.93292379
  -1.24037054  0.65791347 -1.83227469  0.96327113  0.43421913  0.59808962
  -0.16400084 -1.21734657 -1.88876298]
 [ 1.45681202 -0.47194095 -0.51668115  1.58216276 -0.63140247 -0.23795968
  -0.23699844 -0.13745974 -1.03944187 -0.56021371  1.28548905  0.76109313
  -2.97712531 -1.95853164  0.33363677]
 [-0.11295429 -0.37452644  1.0427393  -1.78425933  1.19959205  0.13159092
   0.54840607  0.2533699   0.84614069 -0.25033179 -0.54225803  0.78157133
   0.17510279 -1.25428849  1.34961417]
 [ 1.2107645   1.44143788  0.07969699  0.35053274 -0.38154238 -0.97282931
   0.06547206  0.1765085  -0.66276142  1.82969481 -1.61591476 -0.8153447
  -0.67137121  1.2912054  -0.25659048]
 [-0.32493828 -0.88549128 -0.76449531 -1.30461987  1.01553721  0.60889056
   0.99003399 -0.66235984  2.51191688 -0.9813121  -2.05381367 -0.29210985
   0.13711937  0.75634064 -1.01743069]
 [ 0.59085522  1.70785239 -0.85192477 -0.7401664  -1.70286038  0.24094099
   0.85741377  0.76694066  0.83362317  1.41614694  0.12744248  0.95277198
  -0.95161721 -0.79090653  0.24086618]
 [-0.8180217   0.57170321  1.3750514   0.40353627 -0.73743155 -0.74847586
   1.36536651 -0.79813582  0.08931731 -0.25889486  0.05302142  1.09636939
  -0.53879311 -1.41039285  1.45173615]
 [ 0.22301415  0.72572913 -0.01937808  0.77762307  1.26473756  1.36632632
  -0.27345407 -0.35215232  0.39486824  0.20717154  0.56579628 -0.71093871
  -2.32469883  0.45001987  0.78124562]
 [ 0.6430152   1.65944291  0.85222884 -0.38833337  0.98542591 -0.08493475
   1.255285    0.23798779  0.45351064  0.22772375  0.05450504 -1.4965727
   0.05773997 -2.27254827  0.497803  ]
 [ 0.99191892  2.05110328  0.3740764  -0.71649648 -1.58957659  1.94777016
  -1.42627027  0.8955234  -2.3062695  -0.05148937  0.68322351  0.3252358
  -0.04154044 -0.8247089  -0.90666617]
 [ 1.00862857  0.43572994 -0.16058843  0.20682684 -0.92670237  1.02229087
   1.26097437 -0.77985076  0.10202089  1.0482473  -0.64182853  2.03457678
   1.51062896 -0.27887595  0.97877212]
 [ 1.66219648 -1.24409046  0.61922421 -0.14435019 -0.21653645  0.71030659
  -0.47707723 -1.39975241 -1.42216236 -0.01973534  0.62890132 -0.02387657
  -0.15259542 -0.03079642  1.28931296]
 [ 0.53045333 -0.74591105 -0.28878466  1.20468905 -0.58030216 -0.39473588
  -0.02506427 -1.06491087  0.90236805 -2.18947387  1.45137211 -0.43515836
  -1.25658162  0.28226348 -1.7112236 ]
 [ 0.53735034  0.773624   -0.57591035 -0.38889544  0.94874479 -0.67074472
   0.02250233  0.34761652  1.55995984 -0.50307522  0.03468126  1.13200741
  -2.55672653 -0.26895731 -1.90962033]
 [-1.84007405  1.95697012  0.21127981  1.483487   -0.24141007  0.54045273
  -0.43166677 -0.54695145 -0.07463858  0.12833227  1.53326944 -0.19682801
   0.37983923 -0.25692337  0.1448681 ]
 [-1.31117671  1.09142226 -0.52087614  0.04153348 -0.2141505   0.98464788
   0.52166434  0.0129932   0.17500062  0.34343944  0.75654462  0.50695961
   1.28520704  1.61842451  0.61441535]
 [-1.32260898  1.7478412   2.14990957 -0.36410031 -0.41399926 -2.05889549
   0.77924299 -1.00785882  1.82947226 -2.47728788  0.07239694  0.67448233
  -0.40228725 -0.79546111  0.24923352]
 [-0.52759017 -0.34326486 -0.03937983 -0.55731478 -0.22800951  0.78685349
  -0.39103614  0.16593471 -0.75577814  0.91326798 -1.28700839  0.9564403
  -3.027048   -0.91117554 -1.58981448]
 [ 1.0137531   0.26852421 -1.31215047 -0.57473191  1.33674516 -0.06743153
   0.55087403 -1.52097418 -1.51930263  0.55533117  2.28854297 -0.55894988
   0.57038396 -0.96677579  1.22811571]
 [-0.47884695 -0.46039133 -1.91828853 -0.44244337  0.15791912  1.34910637
  -1.20445031  0.95040571 -0.3747067  -0.3207342  -0.98206495 -1.7369602
  -1.25087716  1.58674589 -1.2319332 ]
 [-0.47803261  1.06143993 -2.15963792  0.3959855  -0.56200449  0.13463965
   0.81286713 -0.20551374 -0.25033528  0.67260531  0.58445455 -0.77292638
  -0.24114029 -1.39738664  1.23833313]
 [-1.26411685  0.13324181  1.69308869  0.75383168 -0.34132184 -0.77769008
  -0.67480789  0.87288064  0.29655312 -0.04623622  2.56686854 -0.87171441
  -0.52556122 -0.41001425  0.18331213]]
Wo: [[ 2.76291171e-01 -3.05163656e-01  7.04611037e-01  5.07285660e-01
  -3.35806239e-01 -2.48899068e+00  7.52847113e-01 -9.92430544e-01
  -6.99626068e-01 -1.94844256e-01 -1.29210235e+00 -8.66960140e-01
   5.07660958e-04 -4.17864358e-01  2.38777577e-01]
 [-9.40648137e-01 -3.17943429e-01 -1.14878661e+00 -3.74562041e-01
   1.97471091e-01 -3.35760446e-01 -1.52273581e+00 -2.79957698e-01
   5.81899260e-02  1.04328943e+00 -1.29098626e-01 -4.98050186e-01
  -1.25715669e+00  1.90492951e+00 -1.03477299e+00]
 [-1.21304646e+00 -2.35373398e-01 -1.90674639e+00  9.89986754e-01
   9.99203188e-02  4.07369228e-01 -1.05974683e+00 -5.88053485e-01
   7.78919672e-01  8.27113263e-01  2.76020545e+00  1.02526738e+00
  -1.96382953e+00  1.79303081e-02 -4.30952675e-01]
 [ 1.02778563e+00 -1.54561208e-01  4.25778463e-01 -3.81291871e-01
   5.48456216e-01  1.40231786e+00 -6.71449924e-01 -2.09528496e+00
  -1.09126794e+00  1.50550462e+00  1.65960513e-01 -3.50790284e-01
  -1.01834244e+00  9.95049457e-01  2.33878540e-01]
 [-1.66479978e-01 -5.94951910e-01 -2.08777945e-01 -3.73002486e-01
   5.19380802e-01  1.22089151e+00 -2.01159456e+00 -1.50471234e+00
  -1.49936181e-01  2.72702430e-02 -1.60437163e+00 -6.74308942e-01
  -4.55614361e-01 -4.97363538e-01 -5.18032039e-01]
 [-1.40282945e-01  8.30034677e-01  6.86235000e-01  5.38731120e-01
   2.21271158e-01 -7.70384664e-01 -5.37663706e-01  6.38841636e-01
   6.05585057e-02  7.45657032e-01  2.11749279e-01  7.53668541e-03
   3.87897415e-01 -1.59321097e+00 -2.12642855e-01]
 [-6.41463754e-01  7.91923376e-01 -7.25224439e-01  1.78527215e-01
  -4.85611092e-01  4.17863115e-01  6.60118375e-01 -2.68625569e-01
   4.39737376e-02  1.14349682e-01  7.11925435e-01 -3.91246440e-01
  -2.50867893e-02 -4.92819131e-01 -1.02814656e+00]
 [ 1.06617761e-01  3.55823794e-01 -8.80860139e-01  1.50339860e+00
  -8.20967831e-01  6.72981909e-01  3.01031006e-01 -1.78013058e+00
  -1.01348391e-01 -1.65038947e+00 -1.83468735e-01  5.98948425e-01
   1.77085407e+00  7.07832402e-01 -1.60486807e+00]
 [-4.29420725e-01  1.42457889e+00  1.02739633e-01  1.68981725e+00
  -8.04509074e-01 -6.37121584e-01 -1.43094170e+00 -4.64088762e-01
   1.17799467e+00 -1.01001402e+00  7.55236655e-01  3.78728221e-01
   7.08729224e-01 -3.40075548e-01 -5.76154213e-02]
 [ 2.05881260e+00 -1.33054693e+00  6.79722744e-01  1.44171888e+00
   3.80126108e-01  1.57626795e+00 -3.05131306e+00 -3.88853752e-01
  -1.25619225e+00 -5.04337611e-01 -1.96210917e-01  3.93356356e-01
  -9.46464936e-01  7.83921822e-01 -1.66845134e+00]
 [ 8.69563488e-01 -3.46707013e-01 -1.87333713e+00 -1.87794441e+00
  -1.89880921e+00 -1.10163424e+00  9.35672207e-03  1.21224868e+00
   6.76566355e-01 -1.44656901e+00 -2.41758906e+00 -4.18621286e-01
  -1.54652325e+00 -2.97711786e-01 -8.10536920e-01]
 [ 2.44832444e+00 -1.85138694e+00  1.86561207e-01  1.72866355e+00
  -5.42609950e-01 -9.16708647e-01  1.54765622e+00 -2.25992767e+00
  -1.85632431e+00 -1.36993157e+00  2.59543030e-01  6.35313249e-01
  -2.67193246e-01  2.05034549e+00 -3.42812544e-01]
 [-1.37440566e-01 -4.40835333e-01  1.10392016e+00 -1.14878125e-01
  -5.18874252e-01  1.57448558e+00  1.18260570e+00  9.00796611e-01
  -1.38149061e+00 -1.18248870e+00 -3.44166296e-01 -3.59200644e-01
  -5.27756304e-01 -3.16942207e-01  5.63023010e-01]
 [-1.10571898e+00  1.63475324e-01 -4.81012122e-01 -5.65104545e-01
  -3.61889366e-01  6.69824183e-01  2.10611348e-01 -8.57944892e-01
   2.68694583e-01  7.63792018e-02  3.60923624e-01 -3.16388735e-01
   9.57024032e-01  3.42043179e-01 -1.18885711e+00]
 [-1.32597093e+00 -1.44918677e+00  3.70889818e-01 -7.23406844e-01
  -3.77431629e-01 -9.39057047e-02  1.21364327e+00  2.17773425e+00
  -1.28632357e-01  1.98952603e+00  5.40259691e-01  1.20158276e+00
  -2.89191104e-01 -1.25467653e+00  4.79501349e-01]
 [ 1.29163587e+00 -1.57448025e+00 -6.63377389e-02  2.14818999e-01
   5.94821119e-01 -1.09615083e+00 -5.65853019e-01  9.28955971e-01
   1.80995616e+00  9.89712786e-02  9.79477931e-01  1.67604692e-01
   4.30380709e-01 -3.91983689e-01 -2.33231131e-01]
 [-5.80671427e-01  9.62175655e-02  1.10465738e+00  1.87352838e-01
   6.54783842e-01 -6.46816708e-01  7.16010725e-01 -3.17398230e+00
  -1.43517665e+00 -3.43354422e-01 -1.83657567e+00  5.61970660e-01
   2.01391798e-01 -9.27370813e-01  8.77803933e-02]
 [-1.52686333e+00 -9.18208457e-01 -3.95109669e-01 -1.62267482e+00
   1.04310749e+00 -6.69600718e-01  1.02012944e+00 -1.54383245e-01
   3.05836282e-01 -9.22679514e-01 -3.14670869e-01 -4.29520449e-01
   2.30117922e-01  1.37512109e+00 -5.69780585e-01]
 [-1.68808279e-01  3.56745350e-01  8.59297683e-01 -1.15372691e-01
  -3.88042947e-01 -5.89091302e-01  4.76666768e-03  2.40254709e-01
  -6.88799797e-01 -3.09979496e-01  7.59437080e-01 -2.69573746e-02
  -5.76263454e-01  7.08536918e-01  7.13030279e-01]
 [ 6.12517873e-01  6.67657339e-01 -3.97157505e-01  2.04205004e-01
   3.14983741e-01  1.21979781e-01 -1.75890045e+00 -1.87833025e-02
   3.51916021e-01  4.95434851e-01 -2.98290989e-01  3.26079428e-02
  -1.80882699e+00 -1.49665532e+00 -2.97099952e+00]
 [-2.29095933e-01  1.62630210e+00  1.75262538e+00 -1.12861008e+00
   6.51995565e-01  1.26092072e+00 -3.03880029e-01 -1.96705800e+00
   1.42515911e+00 -3.57395712e-01 -3.91760909e-01  1.71449593e+00
   4.72649956e-01  8.48132861e-01  1.60842799e+00]
 [-1.42772433e-01 -9.69332181e-01  7.99358767e-01  1.48926514e-02
   7.61882288e-01  4.23142371e-01 -7.37804620e-01  5.53752839e-02
  -3.05224159e-01 -2.03046534e-01 -7.04431541e-03  3.86552334e-01
   2.45233864e-01 -1.23734757e+00  6.72272642e-01]
 [-1.39632475e+00  2.26082998e+00 -7.22013659e-01 -1.69120173e-02
   1.38439163e+00 -1.55546543e-01 -1.22615449e+00 -1.38763516e+00
   3.27301399e-01  4.57411690e-01  8.75115213e-01  3.17492560e-01
  -4.36833885e-01  5.18242808e-01  1.48750011e+00]
 [-7.56638812e-01  3.62528749e+00 -3.73020780e-01  1.29947919e+00
   1.93484359e+00  9.59146982e-01  3.48510000e-01  7.69209192e-01
   1.38217674e+00 -2.60017737e+00  5.04119374e-01 -3.62984114e-01
  -6.52769432e-01  1.58697289e-01  2.19110546e-01]
 [ 5.33278694e-01 -5.49758984e-01  1.16401168e+00 -2.06325085e+00
  -9.42193820e-01 -1.19534031e+00  1.24914145e-01 -4.84498354e-01
   5.44239007e-01 -7.75647507e-01  1.29779488e+00  7.50607847e-01
  -5.09559691e-01 -1.69199027e+00 -1.19009566e+00]]
Wy: [[-1.55198177  1.24246465  0.75752643 -1.27148832  1.88803225]
 [-0.29632246 -2.25846153  1.08955229  1.30638703  0.00707174]
 [-0.89839902  1.23763945 -0.50533983 -0.01706994  0.47155441]
 [ 0.30694779 -0.45955626 -1.0432975   0.75530588 -2.21323885]
 [ 0.33262456  0.27171913  0.52892979 -0.36687122  0.2226941 ]
 [ 0.79733053 -1.04351708  0.05664593  0.38389366 -1.2590085 ]
 [-0.945517    1.5867474   1.04284571 -0.74181305  0.72667271]
 [ 0.41299253  1.41097756  1.14786103 -2.42860733 -0.29546126]
 [ 1.38389736  1.64294864 -0.61331191 -1.22957372  0.26151485]
 [-0.63871168 -0.01167336 -1.1671417   0.77160133  0.57637785]
 [ 0.46471827 -1.09562151 -1.68612204 -1.27584088  0.50100688]
 [-1.79759843  0.66249781  1.77918821 -0.62544803 -0.18267639]
 [ 0.98949507  0.92003725 -0.61406859 -0.17042713  0.1273497 ]
 [-0.26004721  0.58534487  0.3374218   1.3154336  -1.70111231]
 [ 1.19354402  0.82635361 -0.12404023  0.42653394  0.98694829]]
bf: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
bu: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
bc: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
bo: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
by: [[0. 0. 0. 0. 0.]]
(8, 15)
[[ 7.24843743e-01 -6.93123535e-01 -1.03155240e-01 -5.78790635e-01
   5.16692145e-01 -9.76274272e-01  1.31955791e-01 -7.42021203e-01
  -3.86973774e-02 -4.51975913e-01 -5.22852502e-04 -2.17566888e-01
   3.16338342e-06 -1.29969218e-03  7.53088217e-01]
 [ 3.14872929e-01  7.27031535e-01  3.79268469e-02 -1.40335066e-01
   2.49685370e-02 -1.50793611e-01  9.50166087e-01  3.46192598e-04
  -1.69046518e-01  2.74655316e-02 -9.57411960e-01 -4.52351607e-01
   1.40672640e-01 -3.15635873e-01 -7.21144561e-01]
 [-2.20879144e-01  7.28184507e-01  6.38213473e-01  5.50976842e-03
  -1.07291043e-01  4.34417466e-05 -6.83067428e-01  1.35241343e-01
  -7.49959842e-03  2.15355482e-02 -5.36485947e-01 -3.90295224e-05
   1.39376289e-01  1.17776478e-01  6.82964833e-01]
 [ 2.79060928e-03  4.39195390e-01  8.98117180e-06 -1.72827103e-03
   2.84509053e-02 -6.26057372e-01  1.30836622e-01  7.82987049e-01
  -8.26602811e-02  3.73863992e-01  6.33178548e-03 -9.68881416e-03
   7.47355728e-03  2.08886546e-04  1.48263822e-04]
 [-2.92515264e-02 -2.24391849e-01 -6.70281726e-01  6.94759551e-03
  -7.68771017e-01 -1.31566518e-03  6.23851302e-02 -1.07974975e-02
  -2.50624744e-01  1.87683903e-03 -5.27241708e-01 -3.44306121e-03
   4.08357325e-03  9.04731885e-04 -6.77463010e-01]
 [-7.49966708e-01 -1.33609777e-02  6.87008885e-01 -3.35137101e-05
   1.67193178e-03 -1.13795704e-01  1.84798672e-04 -6.80032046e-01
  -9.93446513e-02 -3.71901454e-02 -4.52234158e-03  6.44886331e-01
   7.34600462e-01 -2.26291456e-05  6.30328104e-01]
 [ 6.56754545e-01 -3.25108168e-02 -3.94740678e-01  6.14683037e-02
  -3.27372602e-01 -5.04650710e-02 -6.72588445e-02 -7.60289555e-01
   6.12114531e-02 -7.50932856e-01  1.46085283e-06  6.40830190e-01
  -3.93056542e-04  1.69337779e-02 -1.09767582e-01]
 [ 2.72198327e-01  6.03435554e-05  7.23230030e-01  5.18925406e-02
  -6.22096630e-02 -7.14271940e-03  1.48970374e-01 -1.95634998e-01
   1.66995608e-02 -3.63757437e-01 -5.84486075e-04  7.62253227e-02
   4.16565182e-01  4.07117163e-05 -1.72790494e-05]]
(8, 15)
[[ 9.21713147e-01 -8.55888827e-01 -1.06417803e-01 -6.66049793e-01
   5.73658267e-01 -2.46931417e+00  2.94657103e-01 -9.55015235e-01
  -9.81868808e-01 -4.87267693e-01 -5.43745230e-04 -4.56687156e-01
   2.90809757e-04 -1.60181116e-01  9.82473842e-01]
 [ 3.95886315e-01  9.33778841e-01  3.96699150e-02 -1.41602720e-01
   9.08700422e-02 -1.85825884e-01  1.84170906e+00  9.64787657e-01
  -1.53523785e+00  8.30132635e-01 -1.91396466e+00 -5.31249452e-01
   1.41625246e-01 -3.27640398e-01 -9.30111967e-01]
 [-2.21321002e+00  9.44738362e-01  7.61236925e-01  7.43372921e-03
  -1.07719861e-01  4.25358010e-02 -8.34943258e-01  1.36342871e-01
  -1.50124346e+00  1.58696920e-01 -1.04645812e+00 -8.97242960e-02
   3.73897231e-01  7.45761346e-01  8.37965963e-01]
 [ 1.65315309e-02  5.00197245e-01  2.81809407e-02 -4.58510994e-01
   1.33630728e+00 -1.35250234e+00  1.33085334e-01  1.05343553e+00
  -2.91203859e-01  9.67153920e-01  4.90279248e-01 -1.16338974e-01
   9.22884063e-01  8.13056955e-01  4.96185432e-01]
 [-1.46337875e-01 -2.28276115e-01 -8.12257544e-01  1.78796858e-02
  -1.02798298e+00 -1.39826523e-03  6.70725102e-02 -1.18129122e-02
  -4.00884997e-01  9.90141433e-01 -1.84697072e+00 -4.31170721e-03
   9.62478857e-02  1.42964659e+00 -8.46024766e-01]
 [-9.74696959e-01 -8.60009521e-01  8.46759391e-01 -5.04004070e-05
   2.72140171e-03 -1.17728456e+00  1.68487557e-02 -8.29174343e-01
  -1.01071223e-01 -4.08760551e-02 -4.52727344e-03  7.85175813e-01
   1.04506182e+00 -6.88710142e-01  8.16787632e-01]
 [ 1.58965415e+00 -1.21115460e-01 -9.71316067e-01  1.49510239e+00
  -3.53704051e-01 -1.92573188e+00 -3.55828478e-01 -9.96923520e-01
   2.61875964e-01 -9.75373647e-01  5.27520318e-03  1.04804990e+00
  -9.99524278e-01  1.09150558e+00 -5.69324746e-01]
 [ 2.80078160e-01  6.69562990e-01  9.34511793e-01  6.36114145e-01
  -8.78488769e-01 -7.60392149e-02  7.32433639e-01 -3.78164576e-01
   8.53129884e-01 -3.94185417e-01 -2.13895199e-01  1.47076544e+00
   6.75397639e-01  6.88885347e-02 -8.03056762e-01]]
(8, 5)
[[4.72445839e-03 2.75951246e-01 5.86280916e-03 6.00848145e-04
  7.12860639e-01]
 [5.37769425e-03 9.50253652e-02 7.36387669e-01 2.09357232e-02
  1.42273549e-01]
 [3.31034778e-01 8.30451495e-02 1.54929218e-01 3.63549144e-01
  6.74417112e-02]
 [6.45695184e-02 3.88490891e-01 2.90338716e-01 7.48619680e-03
  2.49114678e-01]
 [1.18883921e-01 1.64110915e-01 5.30923353e-01 1.31666550e-01
  5.44152607e-02]
 [2.19714730e-01 3.26445510e-01 4.03185408e-02 3.19890303e-01
  9.36309156e-02]
 [3.11035391e-02 1.50019751e-01 5.71018030e-01 3.95445483e-02
  2.08314131e-01]
 [5.04553424e-02 6.82779127e-01 7.73375564e-02 1.53302031e-02
  1.74097771e-01]]
"""
