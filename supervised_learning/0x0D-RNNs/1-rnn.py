#!/usr/bin/env python3
"""Module containing the function rnn that performs forward propagation for a
simple RNN."""

import numpy as np


def rnn(rnn_cell, X, h_0):
    """Function that performs forward propagation for a simple RNN.

    Args:
        rnn_cell (RNNCell): An instance of RNNCell that will be used for the
            forward propagation.
        X (numpy.ndarray): Tensor of shape (t, m, i) representing the data to
            be used, where t is the maximum number of time steps, m is the
            batch size, and i is the dimensionality of the data.
        h_0 (numpy.ndarray): Tensor of shape (m, h) representing the initial
            hidden state, where m is the batch size and h is the dimensionality
            of the hidden state.

    Returns: H, Y
        H (numpy.ndarray): A tensor of shape ( , ) containing all of the
            hidden states.
        Y (numpy.ndarray): A tensor of shape ( , ) containing all of the
            outputs.
    """
    pass


# Testing
if __name__ == "__main__":
    RNNCell = __import__('0-rnn_cell').RNNCell

    np.random.seed(1)
    rnn_cell = RNNCell(10, 15, 5)
    rnn_cell.bh = np.random.randn(1, 15)
    rnn_cell.by = np.random.randn(1, 5)
    X = np.random.randn(6, 8, 10)
    h_0 = np.zeros((8, 15))
    H, Y = rnn(rnn_cell, X, h_0)
    print(H.shape)
    print(H)
    print(Y.shape)
    print(Y)

# Expected Output
"""
(7, 8, 15)
[[[ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]
  [ 0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.
    0.          0.          0.          0.          0.        ]]

 [[ 0.28045646  0.31045845  0.99989202  0.99376927 -0.79365613
   -0.96748347  0.87706931  0.99999947  0.99994207  0.99846898
   -0.9998936  -0.99599063 -0.98354763  0.91448074 -0.99979356]
  [ 0.99999489  0.89822683  0.24147191 -0.9803711   0.97621493
   -0.98164731 -0.99994247  0.8986866  -0.99999887 -0.99143954
   -0.96021992  0.69187855  0.99995412 -0.99854789  0.96504703]
  [-0.99374166  0.02430002  0.99860303  0.4806379  -0.95292346
   -0.94778081  0.991254    0.99993389  0.99993849  0.99997438
    0.2696434  -0.99997511 -0.85786199  0.99935457 -0.89784401]
  [-0.99979182  0.02093496 -0.72250908  0.23679642  0.99706722
   -0.73430469  0.48017722 -0.99801748 -0.99338301 -0.76416571
    0.79033555  0.77277814  0.93892152  0.9979191   0.27925815]
  [-0.08989532  0.72431641 -0.9834093  -0.97786125  0.99273298
    0.0648553   0.84989032 -0.99598787  0.9715782  -0.99881274
   -0.99824865 -0.927426   -0.90669173 -0.99667088  0.22362337]
  [ 0.99999349  0.99907395 -0.7328029  -0.82304935 -0.99840166
    0.39011906 -0.97274826  0.93085651  0.96715781  0.99934149
   -0.89743926 -0.99989968  0.99999499 -0.9992797   0.99999925]
  [ 0.99888157  0.94903062  0.6019996  -0.75694962  0.9791763
   -0.99782011 -0.98474459  0.99223421 -0.13680496  0.99841024
   -0.84903426 -0.99979527  0.9954165  -0.98588104  0.98710578]
  [-0.94010273  0.97958914  0.98473426  0.99992105  0.9942734
   -0.99992946 -0.96419606  0.87329534 -0.99969588 -0.84355236
   -0.99990703 -0.15378654 -0.99639429  0.99933908 -0.99999999]]

 [[ 0.9815382   0.99975809 -0.99999611 -0.99889033  0.99999956
   -0.73199948 -0.99997184 -0.99999878 -0.99999997  0.16158584
   -0.12582106  0.57804071 -0.36649548 -0.96993281  0.99996427]
  [ 1.          0.96687647 -0.9999892  -0.99999959 -0.98924235
   -0.89048619 -0.81080926  0.99914494  0.9998444  -0.46987305
    0.99999997 -0.8528737   0.99999703  0.97480799  0.99999998]
  [ 0.42638934  0.99993147 -0.98858238  0.65298896 -0.89179354
    0.93632617 -0.99999792 -0.97639015 -0.98939696  0.99984502
   -0.99998672 -0.9923783  -0.99894376  0.99960725  0.99997181]
  [ 0.98772319 -0.96799441  0.99999999 -0.27872584  0.85383884
   -0.8958682   0.06974888  1.          0.9799729  -0.99885011
   -0.99699069  0.4808139   0.99999974 -0.99968142 -0.97519996]
  [ 0.9999942   0.9999832  -0.99083785 -0.99983663 -0.13661462
    0.99681593 -0.99955258 -0.99878508 -0.99999632  0.9837929
    0.95365885  0.71883932  0.99994997 -0.20605515  0.9860499 ]
  [-0.9997258  -0.70631316 -0.99997618 -0.79925605  0.76156785
   -0.99924321  0.99995866 -0.99999192 -0.99851465  0.99995641
    0.99999921 -0.99825848  0.56082086  0.99972991  0.99214777]
  [-0.97776349  0.98531597 -0.98603718 -0.99997529 -0.99877658
   -0.99846643  0.99990333  0.99998432  0.99999995  0.97310843
    0.99957781 -0.99999256 -0.9928038   0.99999749 -0.99971894]
  [-0.58848448  0.99999996  0.94813681 -0.99985365  0.9987632
   -0.99787217 -0.99999009  0.99999991 -0.70731186 -0.49599127
   -0.99999292 -0.53067278  0.4024293  -0.99915486 -0.67705857]]

 [[ 0.02159932 -0.05766207 -0.94671164 -0.99952243  0.99023373
   -0.99813696  0.98165231  0.95986812  0.73822398 -0.99979411
    0.99986866  0.91883766  0.9319941   0.90178918 -0.99832848]
  [ 0.99576182 -1.          0.86495505  0.98717356  0.14114621
   -0.97843701  1.         -0.60102639  0.99999885 -0.57861717
   -0.98868325 -0.99999997 -0.99999699 -0.69776196  0.99987619]
  [-0.55280313  0.99976263  0.99988335 -0.999997    0.99237028
   -0.99309361 -0.9999836   0.98585978  0.99983873  0.32184158
    0.99234585 -0.99995741 -0.047329   -0.99984502  0.79266748]
  [ 0.99980497  0.99998602 -0.99740112 -0.13760479  0.99965104
   -0.99999817 -0.87675883  0.49148907 -1.          0.7377697
    0.40436698  0.90998368  0.99989247  0.83571544 -0.95175215]
  [-0.99999984  0.74499587  0.11261136  0.99998851  0.66476238
   -0.99992827  0.77148665  0.84746372  0.72194754 -0.5670646
    0.99999972 -0.94629     0.99999989  0.97452966  0.88199388]
  [ 0.94859395  0.99983854  0.99197782  0.95895055  0.99796328
   -0.97890206 -0.99998505  0.95152523 -0.17100548 -0.89926769
   -0.99999915 -0.41555534  1.         -0.99957806 -0.99986577]
  [ 0.83180133  0.89324935 -0.99944177  0.99187644  0.99998602
   -0.99662278 -0.99993212 -0.64624145 -1.          0.35314965
   -0.99999639 -0.39302021 -0.99986923 -0.56620403  0.78013651]
  [-0.87272308  0.99999776 -0.99641196 -0.99995886  0.98727232
   -0.99997324 -0.99998595  0.99999381 -0.91757624 -0.98401138
   -0.99995904  0.98699872 -0.99999997  1.         -0.99999795]]

 [[ 0.99973886  0.99132092 -0.63798222  0.99999984  0.99763983
   -0.99770045  0.92359832  0.99950424 -0.99999996 -0.99924437
   -0.99987421  0.90362999  0.99997099 -0.99292097  0.99850743]
  [ 0.92764281 -0.44729884  0.53546242 -0.99999879 -0.91734635
    0.99976384 -0.05921623 -1.         -0.96364256  0.71184662
    0.99999792  0.33194123  0.62158957  0.99999966 -0.99126856]
  [-0.99984019  0.987753    0.99950054 -0.93855015 -0.97806637
   -0.99103239 -0.99987339  1.          0.94280891  0.99654101
    0.93116071 -0.99994871 -0.99995264  0.99999628 -0.99998721]
  [-0.95371495  0.94934198 -0.96334859  0.56366756  0.99989258
   -0.99999997  0.99999982  0.99995748  0.9996443  -0.99999822
   -0.99996934 -0.999464   -0.99960469  0.59891462  0.99636704]
  [-0.9996027  -0.30383752  0.99999901  0.92225063  0.84680583
    0.85076494  0.9549862   0.99629471  0.99996193 -0.92100452
   -0.99996395 -0.95870281 -0.31280611 -0.04465962 -0.93219184]
  [ 0.99961341  0.99999987  0.86089999 -0.99980201  0.99996125
   -1.         -0.99593006  0.99999861 -0.9996089   0.99998952
   -0.99984119 -0.99995972 -0.73018449  0.99659812 -0.32810449]
  [ 0.49499662  0.94878701  0.99998349 -0.99999992  0.93379934
   -0.96794208  0.98152386  0.99999881  0.99985026 -0.98271635
    0.98016441  0.66655832 -0.36553736 -0.88051456 -0.99999605]
  [-0.98906341  1.         -0.9990707   0.56028665  0.99977379
   -0.9999998   0.81034224  0.99999838 -0.96947611 -0.28188414
   -1.         -0.72740659 -0.99997677 -0.99986566 -0.99949994]]

 [[-0.99938611  0.99999992  0.99813296 -0.99991354 -0.90570141
   -0.99999959  0.99847095  0.99998858 -0.99972975  0.96599203
    0.99989105  0.99998407  0.99992     0.99999936 -0.99999991]
  [-0.71719667 -0.88874829 -0.99999958  0.82287298  0.99999962
   -0.99962592 -0.90300796 -0.99999999  0.99233587 -0.99999978
   -0.99960591 -0.99997517 -0.94404022 -0.95862619  0.99999817]
  [-0.96449187 -0.74738847 -0.99966005  0.05593934  0.91594293
   -0.77541434 -0.99818207  0.98403668 -0.99998974  0.99412781
   -0.99991264 -0.99990515 -0.78348295 -0.99992008  0.99998808]
  [ 0.9058035   0.96669291  0.98574722 -0.99999363  0.83068998
    0.99665673  0.9839001  -0.71499509 -0.28285442 -0.9932421
   -0.99993026  0.85980809 -0.99998982  0.93679885 -0.99631899]
  [-0.74371926  0.99868899  0.02380641 -0.99990951  0.83917959
    0.99982723 -0.98293373 -0.9953362   0.40475569 -0.46463964
   -0.99997256 -0.22627056 -0.99771933  0.99995235  0.99975447]
  [ 0.99956181 -0.57223021 -1.         -1.          0.99961364
    0.20530549  0.99999082 -0.80890552  1.         -0.99926037
   -0.99353919 -0.99999997 -0.99890894 -0.99993789  1.        ]
  [ 1.         -0.88851657 -0.99936741 -0.93368475 -0.99858243
   -0.8420648  -0.49278096  0.99999939 -0.9987008   0.66207558
   -0.99940121 -0.98451163 -0.64710583  0.91651861  0.99999565]
  [-0.92335828  0.9999984  -0.99921281 -0.99999848  0.99987883
    0.14368028 -0.83952698  0.33506722 -0.99983511 -0.71454207
   -0.99094859  0.99998169 -0.93897545  0.94914723 -0.99999569]]

 [[ 0.81091007  0.99999978 -0.99998584  0.99999927 -0.94066741
   -0.99988382 -0.99999856  0.99999999  0.32992442  0.99999663
   -0.99986172 -0.94084609  0.99996864 -0.93731369  0.9981379 ]
  [ 0.99666395  0.95060637  0.99999853 -0.99991407 -0.33407483
    0.9999924  -0.99848749 -0.99959001 -0.99942914 -0.99999891
    0.47030998  0.99925872 -0.99454294  0.98317593 -0.9999999 ]
  [ 0.99999389 -0.9999719   0.54181066 -0.99998821  0.70840716
    0.99305167  0.99917166  0.99977397  0.9999967   0.53627041
   -0.99883948  0.56148125  0.65566993  0.18684821 -0.99994887]
  [-0.97778943  0.99999991 -0.37748688 -0.99852086 -0.96325587
   -0.99993016  0.52183541  0.99999989  0.99865056  0.96606915
   -0.99970049 -0.99999344 -0.99955457  0.91387983 -0.92541392]
  [-0.33524436 -0.99228988  0.99053526 -0.9999978   0.56645869
    0.98686703  0.97420129  0.99971929  0.99999994 -0.99885937
   -0.99998253 -0.99966099 -0.99986669 -0.98748643  0.99519547]
  [ 0.99999936  0.88242893  0.99972709 -0.99989659 -0.98646752
    0.98350029  0.91751893  0.99807048  0.77214128  0.99575033
    0.99511003 -0.99817847  0.93593858 -0.96661803 -0.99999965]
  [ 0.99999871  0.98706162 -0.99962856 -0.99999997  0.99299962
   -0.99991992 -0.37353737 -0.99861834  0.80033388 -0.999521
   -0.99645465 -0.99995551 -0.99997417 -0.99960322 -0.99937268]
  [-0.97563483  1.          0.86680386  0.9478412   0.85215271
   -0.99999729 -0.99879042  1.          0.05365269 -0.98268965
   -1.         -0.6138904  -0.99999967 -0.93869083 -0.99999815]]]
(6, 8, 5)
[[[6.02764349e-04 9.78573782e-01 1.46585015e-03 1.93515759e-02
   6.02762159e-06]
  [6.12269689e-01 6.29839290e-02 1.62654094e-01 7.93670905e-06
   1.62084351e-01]
  [1.99736920e-03 5.22377931e-02 4.67547169e-02 8.99000614e-01
   9.50642515e-06]
  [7.11110766e-02 3.27336483e-07 2.32458061e-03 9.56977764e-02
   8.30866239e-01]
  [1.41053218e-01 1.71447100e-05 2.34415896e-01 2.34153123e-01
   3.90360618e-01]
  [1.68918850e-05 9.85785166e-01 1.40916427e-02 1.76315123e-05
   8.86681940e-05]
  [2.18270168e-02 5.06723004e-01 1.28214688e-01 5.94005471e-06
   3.43229351e-01]
  [6.42820710e-01 1.14977041e-01 2.07116979e-02 2.21259809e-01
   2.30741223e-04]]

 [[4.27688402e-02 1.28547418e-04 7.02097080e-05 2.87816217e-07
   9.57032115e-01]
  [8.77512203e-02 1.45722683e-01 7.30047202e-01 3.60173974e-02
   4.61497335e-04]
  [1.88771525e-02 7.18871246e-01 1.12523544e-04 6.46568826e-02
   1.97482196e-01]
  [4.02519423e-04 2.77138307e-02 9.71758006e-01 1.00608781e-04
   2.50347609e-05]
  [1.68081359e-03 1.19914660e-03 6.22096569e-05 7.52586383e-06
   9.97050304e-01]
  [1.65623211e-03 1.84309538e-09 7.04837061e-05 1.22898450e-03
   9.97044298e-01]
  [3.31019436e-02 2.19904501e-03 1.67712781e-02 9.47869654e-01
   5.80793423e-05]
  [3.88821566e-01 7.46006953e-02 5.26187330e-01 1.44664463e-03
   8.94376411e-03]]

 [[1.27127879e-01 2.55178577e-05 7.11422168e-01 1.59518772e-01
   1.90566283e-03]
  [1.92396643e-02 5.66697620e-02 8.69674118e-01 2.62530433e-02
   2.81634123e-02]
  [1.95622455e-03 4.56324338e-04 9.97387793e-01 5.67342097e-05
   1.42923666e-04]
  [3.23852787e-01 2.73246507e-01 9.69547485e-04 2.74693676e-04
   4.01656465e-01]
  [2.63927720e-03 2.30597523e-05 2.89829584e-01 7.06800178e-01
   7.07901653e-04]
  [5.87307049e-04 9.94837879e-01 4.52722586e-03 1.80139545e-05
   2.95742406e-05]
  [8.48929070e-02 1.99892283e-01 4.75633094e-04 7.49325498e-05
   7.14664244e-01]
  [9.86862092e-01 3.15973762e-04 4.59252609e-03 8.07840715e-03
   1.51000779e-04]]

 [[1.50251289e-01 1.13349048e-01 3.97280374e-02 2.10540508e-04
   6.96461085e-01]
  [1.20501119e-01 1.26276637e-01 2.32078711e-03 7.33183198e-02
   6.77583136e-01]
  [6.83492105e-02 5.12578287e-01 1.99424597e-01 2.19638835e-01
   9.06990368e-06]
  [1.61749503e-02 1.24393171e-05 2.33386499e-01 7.50178542e-01
   2.47569293e-04]
  [1.29383732e-05 1.39683586e-04 2.26281663e-01 7.73565165e-01
   5.50060522e-07]
  [8.44947562e-01 1.20867399e-01 7.94345461e-04 6.71232740e-05
   3.33235706e-02]
  [2.44169572e-01 2.20121690e-03 7.51974640e-01 1.15433455e-03
   5.00236697e-04]
  [5.54985544e-01 1.07253256e-01 9.29988727e-02 2.17693424e-01
   2.70689034e-02]]

 [[8.88640162e-01 1.56698297e-02 5.87276466e-03 3.38939050e-02
   5.59233387e-02]
  [7.20440165e-04 1.51107080e-04 9.69401595e-01 2.89622444e-02
   7.64613664e-04]
  [5.18213410e-03 7.88054298e-02 9.01350047e-01 1.23750625e-03
   1.34248832e-02]
  [8.67188767e-01 5.99752369e-05 3.99155126e-04 2.91664829e-02
   1.03185620e-01]
  [1.56583601e-01 1.29704780e-05 6.58342234e-02 6.60285309e-01
   1.17283896e-01]
  [3.20428542e-02 2.90915538e-05 7.04098394e-01 2.05593966e-02
   2.43270264e-01]
  [1.10339169e-01 8.64722134e-01 1.87112048e-02 1.84963618e-03
   4.37785621e-03]
  [8.91331225e-01 3.16632800e-04 5.87351108e-03 9.84343760e-02
   4.04425538e-03]]

 [[9.08880658e-07 9.99908252e-01 8.69753930e-05 4.21788139e-07
   3.44145611e-06]
  [9.75097062e-01 1.50206450e-02 2.12500754e-04 6.04149827e-03
   3.62829443e-03]
  [9.18773353e-04 1.90293262e-02 9.61409118e-01 1.48018825e-02
   3.84089978e-03]
  [6.39729040e-02 3.61861035e-02 3.21801012e-02 8.67488783e-01
   1.72107765e-04]
  [1.92204055e-05 2.30711346e-06 9.98321849e-01 1.65511248e-03
   1.51079814e-06]
  [1.94110352e-04 9.72377591e-01 2.60185598e-02 1.17648609e-03
   2.33252810e-04]
  [8.89470463e-01 5.79353700e-03 2.44302401e-02 6.32135155e-03
   7.39844085e-02]
  [1.46229725e-02 6.28168571e-01 3.38577126e-01 1.86234640e-02
   7.86667391e-06]]]
"""
